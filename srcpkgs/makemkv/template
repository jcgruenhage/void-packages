# Template file for 'makemkv'
pkgname=makemkv
version=1.15.4
revision=1
archs="x86_64"
wrksrc="${pkgname}-oss-${version}"
build_style=gnu-configure
hostmakedepends="pkg-config"
makedepends="libressl-devel qt5-devel ffmpeg-devel"
short_desc="Blu-ray and DVD ripper"
maintainer="Jan Christian Gr√ºnhage <jan.christian@gruenhage.xyz>"
license="custom: Proprietary License"
homepage="https://www.makemkv.com/"
distfiles="https://www.makemkv.com/download/makemkv-bin-${version}.tar.gz
 https://www.makemkv.com/download/makemkv-oss-${version}.tar.gz"
checksum="45eba7e61a7b467b1fe8de722fa890d556e19f3fc02a7b7f8d846ac8e2badb9a
 82d062d4844d17901293f65dce40e63ae1084fd81accd6913427eda9b2c43fe3"
nopie_files="/usr/bin/makemkvcon"
repository=nonfree

do_configure() {
	./configure
}

do_build() {
	make ${makejobs}
	cd ../${pkgname}-bin-${version}
	mkdir -p tmp
	echo "accepted" > tmp/eula_accepted
	make ${makejobs}
	cd ../${pkgname}-oss-${version}
}

do_install() {
	make DESTDIR=${DESTDIR} install
	cd ../${pkgname}-bin-${version}
	make DESTDIR=${DESTDIR} install
	cd ../${pkgname}-oss-${version}
}

post_install() {
	vlicense License.txt
}
